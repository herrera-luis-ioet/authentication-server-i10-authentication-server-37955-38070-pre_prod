{"is_source_file": true, "format": "Python", "description": "This module defines the User model for managing user authentication and roles within the authentication service.", "external_files": ["app/extensions"], "external_methods": [], "published": ["User", "UserRole", "UserStatus"], "classes": [{"name": "UserRole", "description": "Enum for user roles including ADMIN, USER, and GUEST."}, {"name": "UserStatus", "description": "Enum for user account status including ACTIVE, INACTIVE, SUSPENDED, PENDING_VERIFICATION, and LOCKED."}, {"name": "User", "description": "User model for authentication and user management, defines user properties and methods for handling user actions like login, password verification, and registration."}], "methods": [{"name": "str password(self)", "description": "A hybrid property that raises an exception when accessed, to prevent reading the plain password.", "scope": "User", "scopeKind": "class"}, {"name": "bool verify_password(self, password: str)", "description": "Verifies a password against the stored hash.", "scope": "User", "scopeKind": "class"}, {"name": "None update_login_success(self)", "description": "Updates user fields after a successful login.", "scope": "User", "scopeKind": "class"}, {"name": "None update_login_failure(self)", "description": "Updates user fields after a failed login attempt, checks if the account should be locked.", "scope": "User", "scopeKind": "class"}, {"name": "None unlock_account(self)", "description": "Unlocks a locked user account.", "scope": "User", "scopeKind": "class"}, {"name": "None verify_email(self)", "description": "Marks the user's email as verified and updates status if needed.", "scope": "User", "scopeKind": "class"}, {"name": "None change_password(self, new_password: str)", "description": "Changes the user's password.", "scope": "User", "scopeKind": "class"}, {"name": "bool is_password_expired(self, max_age_days: int = 90)", "description": "Checks if the user's password has expired based on a maximum age.", "scope": "User", "scopeKind": "class"}, {"name": "dict to_dict(self)", "description": "Converts the user object to a dictionary representation.", "scope": "User", "scopeKind": "class"}, {"name": "Optional[\"User\"] find_by_username(cls, username: str)", "description": "Finds a user by their username.", "scope": "User", "scopeKind": "class"}, {"name": "Optional[\"User\"] find_by_email(cls, email: str)", "description": "Finds a user by their email.", "scope": "User", "scopeKind": "class"}, {"name": "Optional[\"User\"] find_by_id(cls, user_id: int)", "description": "Finds a user by their user ID.", "scope": "User", "scopeKind": "class"}, {"name": "str __repr__(self)", "description": "String representation of the User object.", "scope": "User", "scopeKind": "class"}, {"name": "None password(self, password: str)", "scope": "User", "scopeKind": "class", "description": "unavailable"}], "calls": ["bcrypt.generate_password_hash", "bcrypt.check_password_hash", "db.session.commit"], "search-terms": ["User model", "authentication", "user management"], "state": 2, "file_id": 10, "knowledge_revision": 23, "git_revision": "", "ctags": [{"_type": "tag", "name": "ACTIVE", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    ACTIVE = \"active\"$/", "language": "Python", "kind": "variable", "scope": "UserStatus", "scopeKind": "class"}, {"_type": "tag", "name": "ADMIN", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    ADMIN = \"admin\"$/", "language": "Python", "kind": "variable", "scope": "UserRole", "scopeKind": "class"}, {"_type": "tag", "name": "GUEST", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    GUEST = \"guest\"$/", "language": "Python", "kind": "variable", "scope": "UserRole", "scopeKind": "class"}, {"_type": "tag", "name": "INACTIVE", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    INACTIVE = \"inactive\"$/", "language": "Python", "kind": "variable", "scope": "UserStatus", "scopeKind": "class"}, {"_type": "tag", "name": "LOCKED", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    LOCKED = \"locked\"$/", "language": "Python", "kind": "variable", "scope": "UserStatus", "scopeKind": "class"}, {"_type": "tag", "name": "PENDING_VERIFICATION", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    PENDING_VERIFICATION = \"pending_verification\"$/", "language": "Python", "kind": "variable", "scope": "UserStatus", "scopeKind": "class"}, {"_type": "tag", "name": "SUSPENDED", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    SUSPENDED = \"suspended\"$/", "language": "Python", "kind": "variable", "scope": "UserStatus", "scopeKind": "class"}, {"_type": "tag", "name": "USER", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    USER = \"user\"$/", "language": "Python", "kind": "variable", "scope": "UserRole", "scopeKind": "class"}, {"_type": "tag", "name": "User", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^class User(db.Model):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserRole", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^class UserRole(enum.Enum):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserStatus", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^class UserStatus(enum.Enum):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__repr__", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def __repr__(self) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "__tablename__", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    __tablename__ = \"users\"$/", "file": true, "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "_password_hash", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    _password_hash = db.Column(db.String(128), nullable=False)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "change_password", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def change_password(self, new_password: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, new_password: str)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    created_at = db.Column(db.DateTime, default=datetime.utcnow)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    email = db.Column(db.String(120), unique=True, nullable=False, index=True)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "email_verified", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    email_verified = db.Column(db.Boolean, default=False)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "email_verified_at", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    email_verified_at = db.Column(db.DateTime, nullable=True)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "failed_login_attempts", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    failed_login_attempts = db.Column(db.Integer, default=0)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "find_by_email", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def find_by_email(cls, email: str) -> Optional[\"User\"]:$/", "language": "Python", "typeref": "typename:Optional[\"User\"]", "kind": "member", "signature": "(cls, email: str)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "find_by_id", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def find_by_id(cls, user_id: int) -> Optional[\"User\"]:$/", "language": "Python", "typeref": "typename:Optional[\"User\"]", "kind": "member", "signature": "(cls, user_id: int)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "find_by_username", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def find_by_username(cls, username: str) -> Optional[\"User\"]:$/", "language": "Python", "typeref": "typename:Optional[\"User\"]", "kind": "member", "signature": "(cls, username: str)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "first_name", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    first_name = db.Column(db.String(64), nullable=True)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    id = db.Column(db.Integer, primary_key=True)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "is_password_expired", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def is_password_expired(self, max_age_days: int = 90) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, max_age_days: int = 90)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "last_login", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    last_login = db.Column(db.DateTime, nullable=True)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "last_login_attempt", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    last_login_attempt = db.Column(db.DateTime, nullable=True)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "last_name", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    last_name = db.Column(db.String(64), nullable=True)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def password(self) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def password(self, password: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, password: str)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "password_changed_at", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    password_changed_at = db.Column(db.DateTime, nullable=True)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "role", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    role = db.Column(db.Enum(UserRole), default=UserRole.USER, nullable=False)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    status = db.Column(db.Enum(UserStatus), default=UserStatus.PENDING_VERIFICATION, nullable=Fa/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "to_dict", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def to_dict(self) -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "member", "signature": "(self)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "tokens", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    tokens = relationship(\"Token\", back_populates=\"user\", cascade=\"all, delete-orphan\")$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "unlock_account", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def unlock_account(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "update_login_failure", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def update_login_failure(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "update_login_success", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def update_login_success(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "updated_at", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    updated_at = db.Column(db.DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "username", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    username = db.Column(db.String(64), unique=True, nullable=False, index=True)$/", "language": "Python", "kind": "variable", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "verify_email", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def verify_email(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "User", "scopeKind": "class"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "pattern": "/^    def verify_password(self, password: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, password: str)", "scope": "User", "scopeKind": "class"}], "filename": "/home/kavia/workspace/authentication-server-i10-authentication-server-37955-38070-pre_prod/app/models/user.py", "hash": "520edfd52857f0d1e38914a7c53601cf", "format-version": 4, "code-base-name": "default", "fields": [{"name": "ACTIVE = \"active\"", "scope": "UserStatus", "scopeKind": "class", "description": "unavailable"}, {"name": "ADMIN = \"admin\"", "scope": "UserRole", "scopeKind": "class", "description": "unavailable"}, {"name": "GUEST = \"guest\"", "scope": "UserRole", "scopeKind": "class", "description": "unavailable"}, {"name": "INACTIVE = \"inactive\"", "scope": "UserStatus", "scopeKind": "class", "description": "unavailable"}, {"name": "LOCKED = \"locked\"", "scope": "UserStatus", "scopeKind": "class", "description": "unavailable"}, {"name": "PENDING_VERIFICATION = \"pending_verification\"", "scope": "UserStatus", "scopeKind": "class", "description": "unavailable"}, {"name": "SUSPENDED = \"suspended\"", "scope": "UserStatus", "scopeKind": "class", "description": "unavailable"}, {"name": "USER = \"user\"", "scope": "UserRole", "scopeKind": "class", "description": "unavailable"}, {"name": "__tablename__ = \"users\"", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "_password_hash = db.Column(db.String(128), nullable=False)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "created_at = db.Column(db.DateTime, default=datetime.utcnow)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "email = db.Column(db.String(120), unique=True, nullable=False, index=True)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "email_verified = db.Column(db.Boolean, default=False)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "email_verified_at = db.Column(db.DateTime, nullable=True)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "failed_login_attempts = db.Column(db.Integer, default=0)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "first_name = db.Column(db.String(64), nullable=True)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "id = db.Column(db.Integer, primary_key=True)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "last_login = db.Column(db.DateTime, nullable=True)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "last_login_attempt = db.Column(db.DateTime, nullable=True)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "last_name = db.Column(db.String(64), nullable=True)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "password_changed_at = db.Column(db.DateTime, nullable=True)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "role = db.Column(db.Enum(UserRole), default=UserRole.USER, nullable=False)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "status = db.Column(db.Enum(UserStatus), default=UserStatus.PENDING_VERIFICATION, nullable=Fa/", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "tokens = relationship(\"Token\", back_populates=\"user\", cascade=\"all, delete-orphan\")", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "updated_at = db.Column(db.DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)", "scope": "User", "scopeKind": "class", "description": "unavailable"}, {"name": "username = db.Column(db.String(64), unique=True, nullable=False, index=True)", "scope": "User", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"23": ""}]}